/*  Função utilizada na associação de cidades aos Representantes */
function lookup(inputString) {
    if(inputString.length == 0) {
        // Hide the suggestion box.
        $('#suggestions').hide();
    } else {
        $.post("/parceiros/representantesCidades/cidadesAjaxLista", {
            queryString: ""+inputString+""
        }, function(data){
            if(data.length > 0) {
                $('#suggestions').show();
                $('#autoSuggestionsList').html(data);
            }
        });
    }
} // lookup

function fill(thisValue, id) {
    $('#inputString').val(thisValue); // nome da cidade
    $('#hidden').val(id);             // id da cidade
    setTimeout("$('#suggestions').hide();", 200);
}
/* Fim das funções de associação */

//==============================================================================

$(document).ready(function() {
    
    // IMPLEMENTAÇÃO FEITA PARA O FUNCIONAMENTO DO BREADCRUMBS

    var url       = window.location;
    var urlString = url.toString();
    var urlArray  = urlString.split("/");

    var controlador = 4;//urlArray.length - 2;
    var metodo      = 5;//urlArray.length - 1;

    $('#breadcrumbs').load('/parceiros/modulos/breadcrumbs/' + urlArray[controlador] + '/' + urlArray[metodo]);

// ============================================================================================================== //
    
    
    
    
    // AJAX SELECIONA REPRESENTANTE PARA ATRIBUIÇÃO DE VALORES ÀS TAXAS
    $('#selecionaRepresentante').change(function(){

        var valor = this.value;

        $('#msg').html('');
        $('#listaNegociacao').html("<img style='margin-left: 450px; margin-top: 100px;' src='/parceiros/application/images/carregando1.gif' />");
        setTimeout(function(){
            $('#listaNegociacao').load('/parceiros/negociacao/listar/' + valor)
        }, 0);
    });

    // AJAX SELECIONA REPRESENTANTE PARA ASSOCIAÇÃO DE CIDADES AO REPRESENTANTE
    $('#selecionaParceiro').change(function(){ 

        var rep = this.value;

        $('#msg').html('');
        $('#listaCidades').html("<img style='margin-left: 450px; margin-top: 100px;' src='/parceiros/application/images/carregando1.gif' />");
        setTimeout(function(){
            $('#listaCidades').load('/parceiros/representantescidades/cidades/' + rep)
        }, 0);
    });

    // AJAX SELECIONA PERIODO NA TELA DE USUARIO DO REPRESENTANTE PARA LISTAGEM DOS SERVIÇOS EXECUTADOS
    $('#selecionaPeriodo').click(function(){

        var inicio          = $('#inicio').val();
        var fim             = $('#fim').val();
        var coleta          = $('#checkColetas').is(':checked');
        var entrega         = $('#checkEntregas').is(':checked');
        var preenchidos     = $('#checkPreenchidos').is(':checked');
        var naoPreenchidos  = $('#checkNaoPreenchidos').is(':checked');

        if ( inicio == null || inicio == '' || fim == null || fim == '' ) {

            alert('Informe o Período');
        } else {

            $('#listaPeriodo').html("<img style='margin-left: 450px; margin-top: 100px;' src='/parceiros/application/images/carregando1.gif' />");
                setTimeout(function(){
                    $('#listaPeriodo').load('/parceiros/servicos/comissoes/' + fim + '/' + inicio + '/' + coleta + '/' + entrega + '/' + preenchidos + '/' + naoPreenchidos );
            }, 0);
        }
    });
    
    // AJAX SELECIONA PERIODO NA TELA DE USUARIO DO REPRESENTANTE PARA LISTAGEM DOS SERVIÇOS VALIDADOS
    $('#selecionaPeriodoValidados').click(function(){

        var inicio          = $('#inicio').val();
        var fim             = $('#fim').val();
        var coleta          = $('#checkColetas').is(':checked');
        var entrega         = $('#checkEntregas').is(':checked');
        var validados       = $('#checkValidados').is(':checked');
        var naoValidados    = $('#checkNaoValidados').is(':checked');

        if ( inicio == null || inicio == '' || fim == null || fim == '' ) {

            alert('Informe o Período');
        } else {

            $('#listaValidados').html("<img style='margin-left: 450px; margin-top: 100px;' src='/parceiros/application/images/carregando1.gif' />");
                setTimeout(function(){
                    $('#listaValidados').load('/parceiros/servicos/homologacao/' + fim + '/' + inicio + '/' + coleta + '/' + entrega + '/' + validados + '/' + naoValidados );
            }, 0);
        }
    });
    
    
    /*
    $('#selecionaPeriodo').click(function(){

        $.get('/parceiros/servicos/comissoes/',{
            
            fim            : $('#fim').val(),
            inicio         : $('#inicio').val(),
            coleta         : $('#checkColetas').is(':checked'),
            entregas       : $('#checkEntregas').is(':checked'),
            preenchidos    : $('#checkPreenchidos').is(':checked'),
            naoPreenchidos : $('#checkNaoPreenchidos').is(':checked')
        }, function(data){
            alert(data);
           }, 
           "json");
    }); */

    /*
    $('#selecionaIntervalo').change(function(){

        hoje = new Date();
        dia  = hoje.getDay();
        mes  = hoje.getMonth();
        ano  = hoje.getFullYear();

        inicio = this.value;
        fim = (dia + 1) + '-' + (mes + 1) + '-' + ano;

        $('#listaPeriodo').load('/parceiros/servicos/comissoes/' + fim + '/' + inicio);
    }); */

    // AJAX COMBOS DEPENDENTES TESTES

    $('#estadoAjax').change(function(){
        var estado = this.value;
        if (estado == 0){
            $('#cidadeAjax').html('<option value=0>SELECIONE</option>');
        } else {
            $('#cidadeAjax').html('<option>Carregando...</option>');
            setTimeout(function(){
                $("#cidadeAjax").load("/parceiros/testes/cidade/" + estado , 1000);
            });
        }
    });


    $('#dialogAjaxView').click(function(){
    $('#carregaDialog').html("<img style='margin-left: 450px; margin-top: 100px;' src='/parceiros/application/images/carregando1.gif' />");
        setTimeout(function(){
            $('#carregaDialog').load('/parceiros/testes/dialog/');} , 500 );
    });


    // Ajax que lista os serviços prestados pelos Representantes

    $('#selecionaPeriodoServico').click(function(){

        var inicio = $('#inicio').val();
        var fim    = $('#fim').val();
        var rep    = $('#representante').val();

        if (inicio == null || inicio == '' || fim == null || fim == '') {

            alert('Período não pode ser nulo!');
        } else {

            $('#listaServicosPrestados').html("<img style='margin-left: 450px; margin-top: 100px;' src='/parceiros/application/images/carregando1.gif' />");
            setTimeout(function(){
                $('#listaServicosPrestados').load('/parceiros/servicos/coletas_entregas/' + fim + '/' + inicio + '/' + rep )
            }, 0)

        }
    });

});